<%@ page import="java.util.Map" %><%@ page import="shop.Product" %><jsp:useBean id='basket'         scope='session'         class='shop.Basket'          /><%    String empty = request.getParameter("emptyBasket");    if (empty!=null) {        basket.clearBasket();		response.sendRedirect("basket.jsp");    }    String item = request.getParameter("addItem");    	if (item != null) {		basket.addItem(item);		response.sendRedirect("basket.jsp");	}	String remove = request.getParameter("removeProduct");	if(remove!=null){		basket.removeProduct(remove);		response.sendRedirect("basket.jsp");	}	String add = request.getParameter("add");		if(add!=null){		basket.changeQuantity(add, 1);		response.sendRedirect("basket.jsp");	}	String deduct = request.getParameter("deduct");		if(deduct!=null){		basket.changeQuantity(deduct, -1);		response.sendRedirect("basket.jsp");			}		%><html>  <head>    <meta charset="UTF-8" />    <title>Basket</title>    <link rel="stylesheet"              href="stylesheet.css"           type="text/css" />		      <script>        function validate() {            var name_field = document.forms["placeOrder"]["name"].value;            if (!name_field) {                alert("When placing the order the name field cannot be empty.");                return false;            }        }    </script>  </head><body>    <div class="container">      <jsp:include page="header.jsp" />	  <jsp:include page="top_menu.jsp" />	        <div class="content"> 	    <table>        <tr>            <th>Title &nbsp</th>            <th>Quantity </th>            <th> &emsp;</th>			<th> &emsp;</th>            <th>Price &emsp;</th>            <th>Total  &emsp;</th>            <th>Thumbnail &emsp;</th>        </tr>        <tr>            <%                for(Map.Entry<Product, Integer> entry : basket.getItems().entrySet()) {                    Product product = entry.getKey();                    String title = entry.getKey().title;                    String image = entry.getKey().thumbnail;					Integer quantity = entry.getValue();					Integer price = entry.getKey().price;					Integer totalPrice = price * quantity;					String pid = entry.getKey().PID;            %>            <td><%= title %>&nbsp</td>            <td>&emsp;<%= quantity %> </td>            <td><form action="basket.jsp" method="get">                <p></p>				<input type="submit" value="-" />                <input type="hidden" name="deduct" value= <%= pid %> />				</form></td>				<td><form action="basket.jsp" method="get">				<p></p>                <input type="submit" value="+" />                <input type="hidden" name="add" value=<%= pid %> >            </form></td>            <td><%= price / 100 +"." + price % 100 %>&nbsp</td>            <td><%= totalPrice / 100 +"." + totalPrice % 100 %>&nbsp</td>            <td>&emsp;<img src="<%= image %>"	width:85px; height: 85px;/>&nbsp</td>            <td><form action="basket.jsp" method="get">                <input type="hidden" name="removeProduct" value="<%= pid %>">                <input type="submit" value="Remove" />            </form></td>			<td></td>        </tr> <%                }    %>    </table><p> Order total = <%= basket.getTotalString() %><%    if ( basket.getTotal() > 0) {        %>	<form action="order.jsp" onsubmit="return validate()" method="post" name="placeOrder"  style="padding-top: 20px">        <input type="text" name="name" size="20">        <input type="submit" value="Place Order" />    </form>        <form action="basket.jsp" method="get">        <input type="hidden" name="emptyBasket" value="yes">        <input type="submit" value="Empty Basket" />        </form>        <%    }%>	</div>	<jsp:include page="footer.jsp" />		</div> </body></html>